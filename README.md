# Ir HUB: Внешний ИК-передатчик для работы с приложением IrCode Finder по WiFi

Этот проект представляет собой реализацию внешнего ИК-передатчика на базе платы WEMOS D1 mini, который позволяет управлять устройствами через ИК-сигналы, используя приложение **IrCode Finder**. Проект также включает в себя `ИК-приемник` для захвата и анализа сигналов от пультов дистанционного управления.

## Компоненты

- **WEMOS D1 mini** — микроконтроллер на базе ESP8266, обеспечивающий подключение к Wi-Fi и управление периферией.
- **ИК-передатчик** — используется для передачи ИК-сигналов.
- **ИК-приемник TL1838 (VS1838B)** — используется для приема ИК-сигналов от пультов дистанционного управления.

### Поисковые запросы для компонентов:
- [Wemos D1 Mini](https://aliexpress.ru/wholesale?SearchText=wemos+d1+mini)
- [ИК-передатчик с 2 диодами `рекомендуется`](https://aliexpress.ru/wholesale?SearchText=2ch+ir+transmitter+module)
- [ИК-передатчик с 1 диодом](https://aliexpress.ru/wholesale?SearchText=ir+transmitter+module)
- [ИК-приемник TL1838 (VS1838B)](https://aliexpress.ru/wholesale?SearchText=TL1838)

## Возможности

### Интеграция с приложением **IrCode Finder**
В роли WiFi-хаба для управления устройствами по ИК-каналу.

### Веб-интерфейс для считывания кодов с пульта
Пока проверена корректность считывания только кодов протокола `NEC`. Считанный сигнал при необходимости нужно дополнить ведущими `0` для получения общей длины кода в `8` символов. По мере тестирования и выпуска обновлений список протоколов будет дополняться.

## Подключение ИК-приемника

- **VCC** → 3.3V на WEMOS D1 mini
- **GND** → GND на WEMOS D1 mini
- **OUT** → D2 на WEMOS D1 mini

## Схема подключения ИК-передатчика

![WeMos D1 mini](scheme/wemos_d1_transmitter_only_variants.png)  
![WeMos D1 mini](scheme/wemos_d1_transmitter_only_1.jpg)  
![WeMos D1 mini](scheme/wemos_d1_transmitter_only_3.jpg)  

## Настройка и запуск

### Варианты загрузки прошивки:
   - Загрузите [скомпилированную](build/esp8266.esp8266.d1_mini_clone/) `bin`версию через [ESPWebTool](https://esp.huhn.me/).
   - Загрузите проект с помощью Arduino IDE или другой среды разработки.

### Подключение к Wi-Fi:  
После загрузки прошивки, плата попытается подключиться к сохраненной Wi-Fi сети. Если подключение не удалось, устройство создаст точку доступа с именем "AutoConnectAP". Подключитесь к этой точке доступа и настройте Wi-Fi через веб-интерфейс.

### Веб-интерфейс:  
После успешного подключения к Wi-Fi, откройте веб-браузер и перейдите по ссылке [http://irhub.local](http://irhub.local) или по IP-адресу, который будет выведен в мониторе порта. На главной странице вы увидите последний полученный ИК-код и протокол, а также кнопку для сброса и подготовки к приему нового сигнала.  
![Web screen](screenshots/1.png)
![Web screen](screenshots/2.png)  

### Отправка ИК-сигналов:
   - Используйте `специальную версию` приложения IrCode Finder, которая размещена в папке [android](/android). Для подключения к хабу в настройках приложения нужно выбрать тип передатчика `WiFi (IrHUB)`.
   - Для отправки ИК-сигналов без приложения используйте POST-запрос на `/sendIr/` с параметрами `freq` (частота в Гц) и `patt` (паттерн импульсов, разделенных запятыми).

## Отладка

Для отладки включите флаг `DEBUG` в коде, установив его значение в `1`. Это позволит выводить отладочную информацию в монитор порта.

## Лицензия

Этот проект распространяется под лицензией MIT. Вы можете свободно использовать, модифицировать и распространять код в соответствии с условиями лицензии.

## Автор

Проект разработан WasiliySoft. Для связи или вопросов, пожалуйста, посетите [страницу контактов](https://wasiliysoft.ru/contacts/).

## Ссылки

Обычная версия IrCode Finder на [Google Play](https://play.google.com/store/apps/details?id=ru.wasiliysoft.ircodefindernec)  
Обычная версия IrCode Finder на [RuStore](https://www.rustore.ru/catalog/app/ru.wasiliysoft.ircodefindernec)  
Руководство по использованию приложения [на официальном сайте](https://wasiliysoft.ru/ircode-finder-guide/)  
Группа активных пользователей в [Telegram](https://t.me/ircodefinder)
